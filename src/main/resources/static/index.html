<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>个人通讯录系统</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        function fetchContacts() {
            axios.get('/api/contacts')
                .then(response => {
                    const contacts = response.data;
                    const table = document.getElementById('contactsTable');
                    table.innerHTML = '';
                    contacts.forEach(contact => {
                        const row = `<tr>
                            <td>${contact.id}</td>
                            <td>${contact.name}</td>
                            <td>${contact.address}</td>
                            <td>${contact.phone}</td>
                            <td>
                                <button onclick="editContact(${contact.id})">编辑</button>
                                <button onclick="deleteContact(${contact.id})">删除</button>
                            </td>
                        </tr>`;
                        table.innerHTML += row;
                    });
                })
                .catch(error => console.error('Error fetching contacts:', error));
        }

        function addContact() {
            const name = document.getElementById('name').value;
            const address = document.getElementById('address').value;
            const phone = document.getElementById('phone').value;

            axios.post('/api/contacts', {
                name: name,
                address: address,
                phone: phone
            })
                .then(response => {
                    fetchContacts();
                })
                .catch(error => console.error('Error adding contact:', error));
        }

        function editContact(id) {
            const contact = axios.get(`/api/contacts/${id}`)
                .then(response => response.data)
                .catch(error => console.error('Error fetching contact:', error));

            const name = contact.name;
            const address = contact.address;
            const phone = contact.phone;

            document.getElementById('editName').value = name;
            document.getElementById('editAddress').value = address;
            document.getElementById('editPhone').value = phone;
            document.getElementById('editId').value = id;
            document.getElementById('editModal').style.display = 'block';
        }

        function updateContact() {
            const id = document.getElementById('editId').value;
            const name = document.getElementById('editName').value;
            const address = document.getElementById('editAddress').value;
            const phone = document.getElementById('editPhone').value;

            axios.put(`/api/contacts/${id}`, {
                id: id,
                name: name,
                address: address,
                phone: phone
            })
                .then(response => {
                    fetchContacts();
                    document.getElementById('editModal').style.display = 'none';
                })
                .catch(error => console.error('Error updating contact:', error));
        }

        function deleteContact(id) {
            axios.delete(`/api/contacts/${id}`)
                .then(response => {
                    fetchContacts();
                })
                .catch(error => console.error('Error deleting contact:', error));
        }
    </script>
</head>
<body onload="fetchContacts()">
<h1>个人通讯录系统</h1>
<table>
    <tr>
        <th>ID</th>
        <th>姓名</th>
        <th>住址</th>
        <th>电话</th>
        <th>操作</th>
    </tr>
    <tbody id="contactsTable">
    </tbody>
</table>
<button onclick="document.getElementById('addModal').style.display='block'">添加联系人</button>
<div id="addModal" style="display:none">
    <h2>添加联系人</h2>
    <input type="text" id="name" placeholder="姓名">
    <input type="text" id="address" placeholder="住址">
    <input type="text" id="phone" placeholder="电话">
    <button onclick="addContact()">添加</button>
</div>
<div id="editModal" style="display:none">
    <h2>编辑联系人</h2>
    <input type="hidden" id="editId">
    <input type="text" id="editName" placeholder="姓名">
    <input type="text" id="editAddress" placeholder="住址">
    <input type="text" id="editPhone" placeholder="电话">
    <button onclick="updateContact()">更新</button>
</div>
</body>
</html>